# Team NLPtrio | Search engine project for KIK-LG211
Maria, Pietari, Sofia.

## Working hours log

[Link to NLPTrio's log](https://github.com/pietarikoneella/NLPtrio/wiki/Working-hours-log)

## Movie Search (final project)

This is our final project [Movie search](https://github.com/pietarikoneella/NLPtrio/blob/main/final_project/movie_search_flask.py)

[Project folder](https://github.com/pietarikoneella/NLPtrio/tree/main/final_project)

### Installation

The project directory will be the cloned repository:

```
git@github.com:pietarikoneella/NLPtrio.git
cd NLPtrio/final_project
```

(OPTIONAL) work in a virtual environment ```myenv```:

```
python3 -m venv myenv
. myenv/bin/activate
```

Install dependencies:

```
pip3 install -r requirements.txt
pip3 install git+https://github.com/boudinfl/pke.git
```
Run the Movie Search application

```
export FLASK_APP=movie_search_flask.py
export FLASK_DEBUG=True
export FLASK_RUN_PORT=8000
flask run

```


### Documentation for Movie Search:

Welcome to the Movie search engine from NLP-trio!
Our program is an NLP application that will help you choose a movie for every taste.
Our search engine is based on the top 250 movies according to the IMDb (Internet Movie Database) site and we offer our users to find films that will exactly meet their requirements.

#### How does our program work?

We created a program that extracts titles, synopses, year of production, rating, summaries and pictures from the top 250 films on the IMDb website. In addition, it extracts themes from movie synopses. Our program creates its own amount of data for each of the 250 films. You can see this data on individual movie pages generated by our program.

#### How does the search function work?

We have two search methods: Boolean and Tf-idf. Boolean method returns matching movies in order of IMDB rating score, the highest rated movie showing first. Tf-idf method returns matching movies in order of how well they match your query.

Then everything is just like in Google. You write your query in a special search box and select the search method. Next, the program shows you the result of the search: the titles of suitable films, which at the same time work as a link to the individual page for the film, themes of films that our program extracted in advance; and summaries from the IMDb site. You can also expand the results in order to see movie synopses with highlighted query words.

#### Boolean operators, stemmed search and exact match

If the search query is enclosed in quotation marks, the program will look for exact matches in movie synopses.
If there are no quotes in the search query, the program will find all matching stems in movie synopses. For example, if you write houses without quotes, the program will first stem your search query and all synopses, then it will search for the stem hous in the resulting texts. But don't worry, as a result you will get the texts in their original form.

For Boolean search method we use search operators such as “and”, “or”, “not” in our program. Thus, you can find a movie related, for example, to crime and the police at the same time by writing the following query: “crime” and “police” (for exact matches), crime and police (for stemming search). If you type a search word that does not exist in any of the synopses, the program lets you know that there are no matches. If you type "not <a-word-not-in-any-of-the-synopses> and <a-word-in-some-of-the-synopses>", the program knows how to deal with this.
Also you can find this instruction by pressing the “instruction” button on our website. 

#### What can be found on the individual movie pages:
Movie title
Movie photo
Rating from IMDb
Production year
Chart with themes
Synopsis

#### Programming Languages that we use:
Python3, 
HTML, 
CSS, Bootsrap 4

#### Python libraries we use:
Flask,
Beautiful soup, 
urllib,
re,
Pke,
requests,
Spacy, 
Os, 
Numpy, 
matplotlib,
Sklearn, 
Nltk

#### Next, each file of our final project will be analyzed separately.

##### Static folder
In this folder you can find all the pictures that are added to the pages of our site. These are pictures of vintage cameras that are included in the style of our site, and pictures with charts with movie themes that our program generates when you click on a movie link.

##### Templates folder
This is where the files with the code of the layout of our site are stored.

##### imdb-scraping.py
This python program extracts all the information from the IMDb site, such as movie titles, ratings, year of production, synopses, summaries, and links to photos from the movie. The extraction happens in some cases with the help of regexes, in others with the help of the python library Beautiful soup. These materials are written in different files. We run it before using the site itself.


##### imdb-themes.py
This program extracts themes from movie synopses. Initially, with the help of the Spacy python library, it removes all proper nouns from the synopses and only then extracts the themes. This is done so that the names of actors, characters and places do not fall into the themes. This program was also run before using the site.

##### Imdb_photos.txt
By running the Imdb-scraping.py program, links to photos from films are written to this file and separated by the # sign.

##### movie_search_flask.py
This is a python program that uses flask to redirect all functions to a website format. This program has several functions that are responsible for different layouts. Initially, this program collects the materials that we received from all files, and zipes them into one list of lists. Next, you see the search function, where the code for searching for exact matches, stemms, and also for extracting results for the boolean and tf-idf methods are written. The search results themselves are retrieved from the Movies class, whose functions are written in the movies.py program.

##### movie_search_functions.py
This is a regular python program that is embedded in the movie_search_flask.py program. All functions for indexing documents pulled from files, for rewriting search query operations (for example, “or” is rewritten into “|” operation, etc.), full-fledged functions for Boolean and Tf-idf search methods, functions for stemming the search query and the synopses themselves, and a function for creating graphic charts with movie themes are written here.

##### movies.py
This is a small python program that generates a Movie class with all the content that goes into it, i.e. movie id, titles, rating, year of production, themes, summary text, synopsis and photo link.

##### movies.txt
This text file stores movie IDs, titles, year of creation, rating and summary text. All content is separated by "#" sign for later easy exploitation.

##### synopses.txt
This text file stores all movie synopses. The synopsis starts with the <synopsis> tag and ends with the </synopsis> tag. This is done for easy indexing.

##### synopsis_no_name.txt
Here synopses are stored without proper nouns, in order to then extract the themes of the films from them.

##### synopsis_themes.txt
This text file stores 10 themes for each movie, along with a number that indicates how well the theme fits the movie. Our program itself initially extracts themes and writes them to this file.

## Week 5

This is [our week 5 version of the seach engine.](https://github.com/pietarikoneella/NLPtrio/blob/main/week_5/flask_search_themes.py)

The issues for the final project start with "FP".

## Week 4

[Our week 4 folder](https://github.com/pietarikoneella/NLPtrio/tree/main/week_4) with program [flask_search.py](https://github.com/pietarikoneella/NLPtrio/blob/main/week_4/flask_search.py)

## Week 3

This is [our week 3 task](https://github.com/pietarikoneella/NLPtrio/blob/main/week_3/search_engine_week3.py)

## Week 2

### Week 2 task

This is our [week 2 task](https://github.com/pietarikoneella/NLPtrio/blob/main/week_2/search_engine.py), search_engine.py.

## Week 1

### Task 1

[Subject Ideas](https://github.com/pietarikoneella/NLPtrio/blob/main/week_1/Subject_ideas.html)

### Task 2

This is our [Task 2](https://github.com/pietarikoneella/NLPtrio/blob/main/week_1/info_service.py) code. We decided to combine these two programs into one: [Forecast.py](https://github.com/pietarikoneella/NLPtrio/blob/main/week_1/Forecast.py) and [news_headline_extraction.py](https://github.com/pietarikoneella/NLPtrio/blob/main/week_1/news_headline_extraction.py).

